<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ä¿„ç½—æ–¯æ–¹å—</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="/modules/shared/css/common.css">
    <style>
      .game-board {
        border: 3px solid #374151;
        background: #1f2937;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      
      .game-cell {
        border: 1px solid #374151;
        width: 30px;
        height: 30px;
        background: #111827;
      }
      
      .game-cell.filled {
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
      
      .next-piece-board {
        border: 2px solid #374151;
        background: #1f2937;
      }
      
      .next-cell {
        border: 1px solid #374151;
        width: 20px;
        height: 20px;
        background: #111827;
      }
      
      .next-cell.filled {
        border: 1px solid rgba(255, 255, 255, 0.3);
      }
      
      .score-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
      }
      
      .game-button {
        transition: all 0.2s;
      }
      
      .game-button:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      }
      
      .game-button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      
      @keyframes lineClear {
        0%, 100% { background-color: inherit; }
        50% { background-color: white; opacity: 0.8; }
      }
      
      .line-clearing {
        animation: lineClear 0.3s ease-in-out;
      }
      
      /* éŸ³é‡æ»‘å—æ ·å¼ */
      #volumeControl {
        -webkit-appearance: none;
        appearance: none;
        height: 6px;
        border-radius: 3px;
        background: #d1d5db;
        outline: none;
      }
      
      #volumeControl::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: #6366f1;
        cursor: pointer;
        transition: background 0.2s;
      }
      
      #volumeControl::-webkit-slider-thumb:hover {
        background: #4f46e5;
      }
      
      #volumeControl::-moz-range-thumb {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        background: #6366f1;
        cursor: pointer;
        border: none;
        transition: background 0.2s;
      }
      
      #volumeControl::-moz-range-thumb:hover {
        background: #4f46e5;
      }
    </style>
  </head>
  <body class="bg-gray-100 min-h-screen text-gray-800">
    <!-- Navigation -->
    <nav class="nav-container">
      <div class="nav-content">
        <a href="/modules/prompt-tester/" class="nav-item" data-module="prompt-tester">
          Prompt Tester
        </a>
        <a href="/modules/api-tester/" class="nav-item" data-module="api-tester">
          API Tester
        </a>
        <a href="/modules/tetris/" class="nav-item active" data-module="tetris">
          ä¿„ç½—æ–¯æ–¹å—
        </a>
      </div>
    </nav>

    <!-- Header -->
    <header class="bg-white border-b">
      <div class="max-w-6xl mx-auto px-4 flex items-center justify-between h-14">
        <h1 class="font-semibold text-lg">ä¿„ç½—æ–¯æ–¹å—</h1>
        <div class="flex items-center space-x-3">
          <button 
            id="musicToggleBtn" 
            class="px-3 py-1 bg-purple-600 text-white rounded text-sm hover:bg-purple-700 game-button"
            title="åˆ‡æ¢èƒŒæ™¯éŸ³ä¹"
          >
            <span id="musicIcon">ğŸ”‡</span>
          </button>
          <input 
            type="range" 
            id="volumeControl" 
            min="0" 
            max="100" 
            value="50" 
            class="w-20 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
            title="éŸ³é‡æ§åˆ¶"
          />
          <button 
            id="startBtn" 
            class="px-4 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 game-button"
          >
            å¼€å§‹æ¸¸æˆ
          </button>
          <button 
            id="pauseBtn" 
            class="px-4 py-1 bg-yellow-600 text-white rounded text-sm hover:bg-yellow-700 game-button"
            disabled
          >
            æš‚åœ
          </button>
          <button 
            id="resetBtn" 
            class="px-4 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700 game-button"
          >
            é‡ç½®
          </button>
        </div>
      </div>
    </header>

    <!-- Main Game Area -->
    <main class="max-w-6xl mx-auto px-4 py-6">
      <div class="flex flex-col lg:flex-row gap-6 items-start justify-center">
        <!-- Left Side - Game Info -->
        <div class="w-full lg:w-64 space-y-4">
          <!-- Score Card -->
          <div class="score-card">
            <div class="text-center">
              <div class="text-sm opacity-90">åˆ†æ•°</div>
              <div id="score" class="text-3xl font-bold">0</div>
            </div>
            <div class="mt-4 grid grid-cols-2 gap-4 text-sm">
              <div>
                <div class="opacity-90">è¡Œæ•°</div>
                <div id="lines" class="text-xl font-bold">0</div>
              </div>
              <div>
                <div class="opacity-90">ç­‰çº§</div>
                <div id="level" class="text-xl font-bold">1</div>
              </div>
            </div>
          </div>

          <!-- Next Piece -->
          <div class="bg-white border rounded p-4">
            <h3 class="font-medium text-gray-900 mb-2">ä¸‹ä¸€ä¸ª</h3>
            <div id="nextPiece" class="next-piece-board flex justify-center items-center" style="width: 100px; height: 80px;"></div>
          </div>

          <!-- Controls -->
          <div class="bg-white border rounded p-4">
            <h3 class="font-medium text-gray-900 mb-2">æ“ä½œè¯´æ˜</h3>
            <div class="text-xs text-gray-600 space-y-1">
              <div>â† â†’ : å·¦å³ç§»åŠ¨</div>
              <div>â†“ : åŠ é€Ÿä¸‹è½</div>
              <div>â†‘ : æ—‹è½¬</div>
              <div>ç©ºæ ¼ : ç¬é—´ä¸‹è½</div>
              <div>P : æš‚åœ/ç»§ç»­</div>
            </div>
          </div>

          <!-- Game Status -->
          <div id="gameStatus" class="bg-white border rounded p-4 text-center text-sm text-gray-600">
            ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"å¼€å§‹
          </div>
        </div>

        <!-- Center - Game Board -->
        <div class="flex-shrink-0">
          <canvas id="gameCanvas" class="game-board" width="300" height="600"></canvas>
        </div>

        <!-- Right Side - Additional Info -->
        <div class="w-full lg:w-64 space-y-4">
          <!-- Statistics -->
          <div class="bg-white border rounded p-4">
            <h3 class="font-medium text-gray-900 mb-2">ç»Ÿè®¡</h3>
            <div class="space-y-2 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-600">æœ€é«˜åˆ†:</span>
                <span id="highScore" class="font-semibold">0</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">æ–¹å—æ•°:</span>
                <span id="pieces" class="font-semibold">0</span>
              </div>
            </div>
          </div>

          <!-- Speed Info -->
          <div class="bg-white border rounded p-4">
            <h3 class="font-medium text-gray-900 mb-2">é€Ÿåº¦</h3>
            <div class="text-sm text-gray-600">
              <div>å½“å‰é€Ÿåº¦: <span id="speed">1</span> æ ¼/ç§’</div>
              <div class="mt-2 text-xs opacity-75">
                æ¯æ¶ˆé™¤10è¡Œï¼Œé€Ÿåº¦æå‡
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Footer -->
    <footer class="text-center text-xs text-gray-500 py-3 border-t mt-6">
      ä½¿ç”¨æ–¹å‘é”®æ§åˆ¶ â€¢ ç©ºæ ¼é”®å¿«é€Ÿä¸‹è½ â€¢ Pé”®æš‚åœ
    </footer>

    <!-- Background Music -->
    <!-- ç»å…¸ä¿„ç½—æ–¯æ–¹å—èƒŒæ™¯éŸ³ä¹ -->
    <!-- éŸ³ä¹æ–‡ä»¶å¯ä»¥æ”¾ç½®åœ¨ modules/tetris/assets/ ç›®å½•ä¸‹ -->
    <!-- æ”¯æŒçš„æ ¼å¼ï¼šMP3ã€OGGã€WAV -->
    <audio id="bgMusic" loop preload="auto">
      <!-- ä¼˜å…ˆä½¿ç”¨æœ¬åœ°éŸ³ä¹æ–‡ä»¶ -->
      <source src="/modules/tetris/assets/bgmusic.mp3" type="audio/mpeg">
      <source src="/modules/tetris/assets/bgmusic.ogg" type="audio/ogg">
      <source src="/modules/tetris/assets/bgmusic.wav" type="audio/wav">
      <!-- å¤‡ç”¨ï¼š8ä½é£æ ¼éŸ³ä¹ï¼ˆéœ€è¦ç½‘ç»œè¿æ¥ï¼‰ -->
      <source src="https://freemusicarchive.org/file/music/ccCommunity/Javolenus/THE_TETRIS_THEME/THE_TETRIS_THEME.mp3" type="audio/mpeg">
    </audio>

    <script src="/modules/shared/js/common.js"></script>
    <script src="/modules/tetris/app.js"></script>
  </body>
</html>

